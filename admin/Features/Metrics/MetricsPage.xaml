<Page x:Class="admin.Features.Metrics.MetricsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
    xmlns:local="clr-namespace:admin.Features.Metrics"
    xmlns:controls="clr-namespace:admin.Features.Common.Controls"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
    xmlns:sp="clr-namespace:ScottPlot.WPF;assembly=ScottPlot.WPF"
    xmlns:hc="https://handyorg.github.io/handycontrol"
    mc:Ignorable="d" 
    >
    <hc:FlexPanel
        FlexWrap="Wrap"
        >
        <!-->Первая строка<-->
        <ContentControl
            Content="{Binding PingPlot, Mode=OneTime}"
            VerticalAlignment="Stretch"
            HorizontalAlignment="Stretch"
            MinHeight="180"
            MinWidth="560"
            Margin="16"
        />
        <controls:DashboardCard
            Title="Статус сервера"
            SubText="Текущее состояние сервера"
            Icon="Wifi124"
            AccentBrush="{Binding AccentBrush, Mode=OneWay}"
            >
            <StackPanel>
                <TextBlock
                    Text="{Binding HealthStatus, Mode=OneWay}"
                    FontSize="20"
                    FontWeight="SemiBold"
                    TextWrapping="WrapWithOverflow"
                    Foreground="{Binding AccentBrush}"
                />
                <TextBlock
                    Text="{Binding Problems, Mode=OneWay}"
                    FontSize="18"
                />
            </StackPanel>
        </controls:DashboardCard>
        <controls:DashboardCard
            Title="Всего запросов"
            SubText="Запросов за время работы"
            Icon="BookNumber24"
            >
            <TextBlock
                Text="{Binding TotalRequests, Mode=OneWay}"
                FontSize="28"
                FontWeight="SemiBold"
                TextWrapping="WrapWithOverflow"
                Foreground="{DynamicResource SystemAccentColorPrimaryBrush}"
            />
        </controls:DashboardCard>

        <!-->Вторая строка<-->
        <controls:DashboardCard
            Title="Отклоненных запроов"
            SubText="Запросы с ошибками"
            Icon="BookExclamationMark24"
            >
            <TextBlock
                Text="{Binding FailedRequests, Mode=OneWay}"
                FontSize="28"
                FontWeight="SemiBold"
                TextWrapping="WrapWithOverflow"
                Foreground="{DynamicResource SystemAccentColorPrimaryBrush}"
            />
        </controls:DashboardCard>
        <ContentControl
            Content="{Binding DbLatencyPlot, Mode=OneTime}"
            VerticalAlignment="Stretch"
            HorizontalAlignment="Stretch"
            MinHeight="180"
            MinWidth="560"
            Margin="16"
        />
        <controls:DashboardCard
            Title="Время работы"
            SubText="Время с запуска сервера"
            Icon="Clock24"
            >
            <TextBlock
                Text="{Binding Uptime, Mode=OneWay}"
                FontSize="28"
                FontWeight="SemiBold"
                TextWrapping="WrapWithOverflow"
                Foreground="{DynamicResource SystemAccentColorPrimaryBrush}"
            />
        </controls:DashboardCard>

        <!-->Третья строка<-->
        <ContentControl
            Content="{Binding MemoryUsagePlot, Mode=OneTime}"
            VerticalAlignment="Stretch"
            HorizontalAlignment="Stretch"
            MinHeight="180"
            MinWidth="560"
            Margin="16"
        />
        <controls:DashboardCard
            Title="Нагрузка ЦП"
            SubText="Процент нагрузки центрального процессора"
            Icon="DeveloperBoard24"
            >
            <StackPanel>
                <ProgressBar
                    Value="{Binding CpuUsage, Mode=OneWay}"
                    Height="20"
                    Width="125"
                    Minimum="0"
                    Maximum="100"
                    Foreground="{DynamicResource SystemAccentColorPrimaryBrush}"
                />
                <TextBlock
                    Text="{Binding CpuUsageText, Mode=OneWay}"
                    TextAlignment="Center"
                    Foreground="{DynamicResource SystemAccentColorPrimaryBrush}"
                />
            </StackPanel>
        </controls:DashboardCard>
        <controls:DashboardCard
            Title="Память сервера"
            SubText="Занятое пространство диска"
            Icon="HardDrive20"
            >
        <TextBlock
                Text="{Binding DiskUsage, Mode=OneWay}"
                FontSize="28"
                FontWeight="SemiBold"
                TextWrapping="WrapWithOverflow"
                Foreground="{DynamicResource SystemAccentColorPrimaryBrush}"
            />
        </controls:DashboardCard>
    </hc:FlexPanel>
</Page>

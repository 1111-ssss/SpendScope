<Page x:Class="admin.Features.Home.HomePage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
    xmlns:local="clr-namespace:admin.Features.Home"
    xmlns:controls="clr-namespace:admin.Features.Common.Controls"
    xmlns:converters="clr-namespace:admin.Features.Common.Converters"
    xmlns:sp="clr-namespace:ScottPlot.WPF;assembly=ScottPlot.WPF"
    xmlns:hc="https://handyorg.github.io/handycontrol"
    Foreground="{DynamicResource TextFillColorPrimaryBrush}"
    >

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="auto"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <ui:Card
            Grid.Column="0"
            Margin="10,10,10,10"
            Width="300"
            VerticalAlignment="Top"
            >
            <StackPanel>
                <Ellipse
                    Width="200"
                    Height="200"
                    Margin="10,30,10,10"
                    >
                    <Ellipse.Fill>
                        <ImageBrush
                            ImageSource="{Binding AvatarUri}"
                            Stretch="UniformToFill"
                        />
                    </Ellipse.Fill>
                </Ellipse>
                <TextBlock
                    Text="{Binding Username}"
                    Foreground="{DynamicResource AccentTextFillColorSecondaryBrush}"
                    FontSize="22"
                    HorizontalAlignment="Center"
                    Margin="0,0,0,5"
                />
                <TextBlock
                    Text="{Binding UsernameSub}"
                    FontSize="14"
                    Visibility="{Binding UsernameSub, Converter={StaticResource NullToVisibilityConverter}}"
                    HorizontalAlignment="Center"
                    Margin="0,0,0,5"
                />
                <TextBlock
                    Text="{Binding UserRole}"
                    FontSize="14"
                    Visibility="{Binding UserRole, Converter={StaticResource NullToVisibilityConverter}}"
                    HorizontalAlignment="Center"
                    Margin="0,0,0,10"
                />
            </StackPanel>
        </ui:Card>
        <StackPanel
            Grid.Column="1"
            Margin="10,10,10,10"
            HorizontalAlignment="Stretch"
            >
            <TextBlock
                Text="Статистика сервера и метрики"
                FontSize="28"
                FontWeight="SemiBold"
                Foreground="{DynamicResource AccentTextFillColorSecondaryBrush}"
                TextWrapping="WrapWithOverflow"
                Margin="5,5,5,10"
            />
            <WrapPanel>
                <controls:DashboardCard
                    Title="Статус сервера"
                    SubText="Текущее состояние сервера"
                    Icon="Wifi124"
                    AccentBrush="{Binding AccentBrush}"
                    >
                    <StackPanel>
                        <TextBlock
                            Text="{Binding HealthStatus}"
                            FontSize="22"
                            FontWeight="SemiBold"
                            TextWrapping="WrapWithOverflow"
                            Foreground="{Binding AccentBrush}"
                        />
                        <TextBlock
                            Text="{Binding Problems}"
                            FontSize="16"
                            FontWeight="Normal"
                        />
                    </StackPanel>
                </controls:DashboardCard>

                <controls:DashboardCard
                    Title="Задержка"
                    SubText="Время ответа сервера"
                    Icon="Timer24"
                    >
                    <TextBlock
                        Text="{Binding PingValue}"
                        FontSize="28"
                        FontWeight="SemiBold"
                        TextWrapping="WrapWithOverflow"
                        Foreground="{DynamicResource SystemAccentColorPrimaryBrush}"
                    />
                </controls:DashboardCard>

                <controls:DashboardCard
                    Title="Подключения"
                    SubText="Активные подключения"
                    Icon="PhoneScreenTime24"
                    >
                    <TextBlock
                        Text="{Binding ActiveConnections}"
                        FontSize="28"
                        FontWeight="SemiBold"
                        TextWrapping="WrapWithOverflow"
                        Foreground="{DynamicResource SystemAccentColorPrimaryBrush}"
                    />
                </controls:DashboardCard>

                <controls:DashboardCard
                    Title="Всего запросов"
                    SubText="Запросов за время работы"
                    Icon="BookNumber24"
                    >
                    <TextBlock
                        Text="{Binding TotalRequests}"
                        FontSize="28"
                        FontWeight="SemiBold"
                        TextWrapping="WrapWithOverflow"
                        Foreground="{DynamicResource SystemAccentColorPrimaryBrush}"
                    />
                </controls:DashboardCard>

                <controls:DashboardCard
                    Title="Время работы"
                    SubText="Время с запуска сервера"
                    Icon="Clock24"
                    >
                    <TextBlock
                        Text="{Binding Uptime}"
                        FontSize="28"
                        FontWeight="SemiBold"
                        TextWrapping="WrapWithOverflow"
                        Foreground="{DynamicResource SystemAccentColorPrimaryBrush}"
                    />
                </controls:DashboardCard>
            </WrapPanel>
        </StackPanel>
    </Grid>
</Page>

<Page x:Class="admin.Features.Home.HomePage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
    xmlns:local="clr-namespace:admin.Features.Home"
    xmlns:controls="clr-namespace:admin.Features.Common.Controls"
    xmlns:sp="clr-namespace:ScottPlot.WPF;assembly=ScottPlot.WPF"
    Foreground="{DynamicResource TextFillColorPrimaryBrush}"
    >

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="auto"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <ui:Card
            Grid.Column="0"
            Margin="10,10,10,10"
            VerticalAlignment="Top"
            >
            <StackPanel>
                <ui:Image
                    Source="{Binding AvatarUri}"
                    Width="128"
                    Height="128"
                    Stretch="UniformToFill"
                    CornerRadius="32"
                    Margin="0,0,0,10"
                />
                <Label
                    Content="{Binding Username}"
                    Foreground="{Binding AccentTextFillColorSecondaryBrush}"
                    FontSize="20"
                    HorizontalAlignment="Center"
                    Margin="0,0,0,5"
                />
                <Label
                    Content="{Binding UserRole}"
                    FontSize="16"
                    HorizontalAlignment="Center"
                    Margin="0,0,0,10"
                />
            </StackPanel>
        </ui:Card>
        <StackPanel
                Grid.Column="1"
                Margin="10,10,10,10"
                HorizontalAlignment="Stretch"
                >
            <TextBlock
                Text="Статистика сервера и метрики"
                FontSize="28"
                FontWeight="SemiBold"
                Foreground="{Binding AccentTextFillColorSecondaryBrush}"
                TextWrapping="WrapWithOverflow"
                Margin="5,5,5,10"
            />
            <WrapPanel>
                <controls:DashboardCard
                    Title="Статус сервера"
                    SubText="Текущее состояние сервера"
                    Icon="Wifi124"
                    AccentBrush="{Binding AccentBrush}"
                    >
                    <StackPanel>
                        <TextBlock
                            Text="{Binding HealthStatus}"
                            FontSize="22"
                            FontWeight="SemiBold"
                            TextWrapping="WrapWithOverflow"
                            Foreground="{Binding AccentBrush}"
                        />
                        <TextBlock
                            Text="{Binding Problems}"
                            FontSize="16"
                            FontWeight="Normal"
                        />
                    </StackPanel>
                </controls:DashboardCard>

                <controls:DashboardCard
                    Title="Задержка"
                    SubText="Время ответа сервера"
                    Icon="Timer24"
                    >
                    <TextBlock
                        Text="{Binding PingValue}"
                        FontSize="28"
                        FontWeight="SemiBold"
                        TextWrapping="WrapWithOverflow"
                        Foreground="{DynamicResource SystemAccentColorPrimaryBrush}"
                    />
                </controls:DashboardCard>

                <controls:DashboardCard
                    Title="Подключения"
                    SubText="Активные подключения"
                    Icon="PhoneScreenTime24"
                    >
                    <TextBlock
                        Text="{Binding ActiveConnections}"
                        FontSize="28"
                        FontWeight="SemiBold"
                        TextWrapping="WrapWithOverflow"
                        Foreground="{DynamicResource SystemAccentColorPrimaryBrush}"
                    />
                </controls:DashboardCard>
                
                <controls:DashboardCard
                    Title="Всего запросов"
                    SubText="Запросов за время работы"
                    Icon="BookNumber24"
                    >
                    <TextBlock
                        Text="{Binding TotalRequests}"
                        FontSize="28"
                        FontWeight="SemiBold"
                        TextWrapping="WrapWithOverflow"
                        Foreground="{DynamicResource SystemAccentColorPrimaryBrush}"
                    />
                </controls:DashboardCard>

                <controls:DashboardCard
                    Title="Время работы"
                    SubText="Время с запуска сервера"
                    Icon="Clock24"
                    >
                    <TextBlock
                        Text="{Binding Uptime}"
                        FontSize="28"
                        FontWeight="SemiBold"
                        TextWrapping="WrapWithOverflow"
                        Foreground="{DynamicResource SystemAccentColorPrimaryBrush}"
                    />
                </controls:DashboardCard>

                <ui:Card Margin="8" MinWidth="200" MaxWidth="240" Background="{DynamicResource CardBackgroundFillColorDefaultBrush}">
                    <StackPanel Margin="16">
                        <ui:SymbolIcon Symbol="Wifi124" FontSize="32" Foreground="{Binding ServerStatusBrush}"/>
                        <TextBlock Text="Статус сервера" 
                                       HorizontalAlignment="Center"
                       FontSize="18" FontWeight="SemiBold" Margin="0,4,0,4"/>
                        <Separator Margin="0,0,0,4" />
                        <TextBlock Text="Сервер активен и работает" 
                       FontSize="16" FontWeight="Medium"
                                       TextWrapping="WrapWithOverflow"
                       Foreground="{Binding ServerStatusBrush}"/>
                    </StackPanel>
                </ui:Card>
                <ui:Card Margin="8" MinWidth="200">
                    <StackPanel Margin="16">
                        <ui:SymbolIcon Symbol="People24" FontSize="32" Foreground="{DynamicResource SystemAccentColorBrush}"/>
                        <TextBlock Text="Онлайн пользователей" 
                       FontSize="14" Margin="0,8,0,2" Opacity="0.8"/>
                        <TextBlock Text="{Binding OnlineUsers}" 
                       FontSize="28" FontWeight="Bold"/>
                    </StackPanel>
                </ui:Card>

                <!-- С прогресс-баром -->
                <ui:Card Margin="8" MinWidth="200">
                    <StackPanel Margin="16">
                        <TextBlock Text="Загрузка CPU" FontSize="16" FontWeight="SemiBold"/>
                        <ProgressBar Value="50" Height="12" Margin="0,8"/>
                        <TextBlock Text="CPU загружен на 50%" 
                       HorizontalAlignment="Right" FontSize="14" Margin="0,4,0,0"/>
                    </StackPanel>
                </ui:Card>
            </WrapPanel>
        </StackPanel>
    </Grid>
</Page>
